# Report: J-20260217-001 - Define Dialogue Quiz API schema and manager

## Summary (What changed)
- Added quiz domain model (`QuizData`) for seed/request payload and normalized question response.
- Added quiz manager contract (`IQuizGenerationManager`) with explicit success/failure callback path.
- Implemented `DialogueQuizLlmManager` using summary seed (`SummaryData.expressions`, `SummaryData.words`) to call Gemini API and parse/sanitize quiz questions.
- Enforced hard cap of `5` questions with invalid-item filtering and parsing fallback to explicit error callback.
- Wired quiz manager provider entrypoint in `LearningDependencyProvider`.
- Added unit tests for seed assembly, parser sanitization, malformed payload handling, and max-5 cap behavior.

## Files touched (Actual)
- `app/src/main/java/com/example/test/fragment/dialoguelearning/di/LearningDependencyProvider.java`
- `app/src/main/java/com/example/test/fragment/dialoguelearning/manager_contracts/IQuizGenerationManager.java`
- `app/src/main/java/com/example/test/fragment/dialoguelearning/model/QuizData.java`
- `app/src/main/java/com/example/test/summary/DialogueQuizLlmManager.java`
- `app/src/test/java/com/example/test/summary/DialogueQuizLlmManagerTest.java`

## How to test (Step-by-step)
1) Checkout branch: `feat/J-20260217-001-dialogue-quiz-api-schema-manager`
2) Run build gate:
   - `./gradlew :app:spotlessApply :app:spotlessCheck :app:assembleDebug :app:testDebugUnitTest`
3) Verify tests:
   - `DialogueQuizLlmManagerTest` passes
4) (Optional runtime) Trigger quiz generation call with summary seed data and ensure callback returns max 5 questions.

## Build Result
- Ran:
  - `./gradlew :app:spotlessApply :app:spotlessCheck :app:assembleDebug :app:testDebugUnitTest`
- Result: PASS
- Notes:
  - spotless apply/check passed
  - assemble debug passed
  - unit test task passed

## Logcat
- Tag: `JOB_J-20260217-001`
- Filter:
  - `adb logcat | grep JOB_J-20260217-001`
- Expected:
  - quiz request start log with seed counts (expression/word counts only)
  - quiz parse result log with final count and cap-applied flag
  - parse/request failure category log on error path
- Observed:
  - Runtime Logcat verification not executed in coding stage (build/test only)

## QA Checklist (Copy from Job + Observations)
### UX
- [ ] 시나리오 1: summary seed가 있는 세션에서 quiz generation 요청이 정상 시작된다. (QA 미실행)
- [ ] 시나리오 2: 문제 수가 5개를 초과하는 응답에서도 최종 결과는 5개 이하로 제한된다. (단위테스트로 로직 검증, UX QA 미실행)
- [ ] 시나리오 3: 비정상 응답(JSON shape mismatch) 시 에러 경로가 동작하고 앱이 유지된다. (단위테스트로 파싱 실패 경로 검증, UX QA 미실행)
- [ ] 시나리오 4: 기존 summary 관련 API 호출(미래 피드백/단어 추출)이 회귀 없이 동작한다. (회귀 QA 미실행)

### Logcat
- [ ] 기대 로그 1: request seed 개수(표현/단어, 민감정보 제외) 및 quiz 요청 시작 로그 (QA 미실행)
- [ ] 기대 로그 2: 응답 파싱 결과(문항 수 cap 적용 여부) 또는 오류 로그 (QA 미실행)

## Risks / Edge cases
- Model output schema variance may still produce zero valid questions and trigger failure callback by design.
- Current integration scope is contract/manager/provider only; UI wiring is intentionally deferred to subsequent job.
- Network/API transient failures are surfaced to callback, so caller retry UX is required in the next stage.

## Rollback
- Revert quiz manager/contract/model additions and provider wiring:
  - `app/src/main/java/com/example/test/fragment/dialoguelearning/manager_contracts/IQuizGenerationManager.java`
  - `app/src/main/java/com/example/test/fragment/dialoguelearning/model/QuizData.java`
  - `app/src/main/java/com/example/test/summary/DialogueQuizLlmManager.java`
  - `app/src/main/java/com/example/test/fragment/dialoguelearning/di/LearningDependencyProvider.java`
  - `app/src/test/java/com/example/test/summary/DialogueQuizLlmManagerTest.java`
