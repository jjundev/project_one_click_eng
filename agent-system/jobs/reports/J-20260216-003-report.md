# Report: J-20260216-003 - setting-fragment-runtime-config

## Summary (What changed)
- Replaced settings tab destination and screen from empty placeholder to functional `SettingFragment`.
- Added persistent runtime settings storage (`AppSettings`, `AppSettingsStore`) using `SharedPreferences` (`app_settings`).
- Implemented settings UI sections: mute, timer placeholder, LLM API/model settings with API test, Android TTS settings.
- Wired mute-all setting to block both TTS and recorded-audio playback in dialogue learning.
- Wired runtime LLM API key fallback/override and per-feature model selection into manager/provider construction paths.
- Wired runtime Android TTS speech rate and locale into playback coordinator.
- Kept API-based TTS as "준비 중" UI only (no execution logic).

## Files touched (Actual)
- `repo/app/src/main/java/com/example/test/activity/MainActivity.java`
- `repo/app/src/main/java/com/example/test/fragment/DialogueLearningFragment.java`
- `repo/app/src/main/java/com/example/test/fragment/DialogueSelectFragment.java`
- `repo/app/src/main/java/com/example/test/fragment/DialogueSummaryFragment.java`
- `repo/app/src/main/java/com/example/test/fragment/SettingFragment.java` (new)
- `repo/app/src/main/java/com/example/test/fragment/SettingsEmptyFragment.java` (deleted)
- `repo/app/src/main/java/com/example/test/fragment/dialoguelearning/coordinator/DialoguePlaybackCoordinator.java`
- `repo/app/src/main/java/com/example/test/fragment/dialoguelearning/di/LearningDependencyProvider.java`
- `repo/app/src/main/java/com/example/test/manager_gemini/DialogueGenerateManager.java`
- `repo/app/src/main/java/com/example/test/manager_gemini/ExtraQuestionManager.java`
- `repo/app/src/main/java/com/example/test/manager_gemini/SentenceFeedbackManager.java`
- `repo/app/src/main/java/com/example/test/manager_gemini/SpeakingFeedbackManager.java`
- `repo/app/src/main/java/com/example/test/settings/AppSettings.java` (new)
- `repo/app/src/main/java/com/example/test/settings/AppSettingsStore.java` (new)
- `repo/app/src/main/java/com/example/test/summary/SessionSummaryLlmManager.java`
- `repo/app/src/main/res/layout/fragment_setting.xml` (new)
- `repo/app/src/main/res/layout/fragment_settings_empty.xml` (deleted)
- `repo/app/src/main/res/menu/menu_main_bottom_nav.xml`
- `repo/app/src/main/res/navigation/nav_graph.xml`
- `repo/app/src/main/res/values/strings.xml`

## How to test (Step-by-step)
1) 앱 실행 후 하단 `설정` 탭 진입 → `SettingFragment` UI 확인.
2) `모든 재생 음소거` ON 후 학습 화면에서 TTS/녹음 재생 버튼 동작 확인 (차단 토스트/무음 확인).
3) 설정에서 API key override 비움/입력 각각 저장 후 `API 테스트` 실행 성공/실패 문구 확인.
4) LLM 기능별 모델 값 변경 후 학습/대본생성/요약 진입 시 런타임 모델 값으로 요청되는지 확인.
5) TTS 속도/로케일 변경 후 학습 화면 재생 음성 반영 여부 확인.
6) Timer 섹션이 비활성 + 준비중 placeholder로만 보이는지 확인.

## Build Result
- Ran:
  - `./gradlew :app:spotlessApply :app:spotlessCheck :app:assembleDebug :app:testDebugUnitTest`
- Result: PASS
- Notes:
  - `testDebugUnitTest`는 실행 대상 소스가 없어 `NO-SOURCE`로 완료됨.

## Logcat
- Tag: `JOB_J-20260216-003`
- Filter:
  - `adb logcat | grep JOB_J-20260216-003`
- Expected:
  - 설정 저장/적용 로그 출력
  - mute 차단 로그 및 API 테스트 성공/실패 로그 출력
  - API key 값 자체는 미출력
- Observed:
  - 로컬 빌드 단계에서 Logcat 실기기 검증은 미수행

## QA Checklist (Copy from Job + Observations)
### UX
- [ ] 시나리오 1: 설정 탭 진입 후 무음 모드 ON/OFF 전환 시 학습 화면 재생 동작이 즉시 반영된다. (코드 반영 완료, 기기 미검증)
- [ ] 시나리오 2: API key/모델 변경 후 API 테스트 버튼 결과가 성공/실패 상태로 표시된다. (코드 반영 완료, 기기 미검증)
- [ ] 시나리오 3: TTS 속도/로케일 변경 후 메시지 재생 음성이 변경값으로 동작한다. (코드 반영 완료, 기기 미검증)
- [ ] 시나리오 4: 타이머 설정은 표시되지만 비활성/준비중 상태임을 확인한다. (코드 반영 완료, 기기 미검증)

### Logcat
- [ ] 기대 로그 1: 설정 저장/적용 이벤트 로그가 DEBUG 가드 하에 출력된다. (코드 반영 완료, 기기 미검증)
- [ ] 기대 로그 2: mute 차단 또는 API 테스트 결과 로그가 민감정보 없이 출력된다. (코드 반영 완료, 기기 미검증)

## Risks / Edge cases
- 음성엔진별 지원 로케일 차이로 일부 로케일은 내부적으로 `en-US` fallback이 적용될 수 있음.
- 기존 캐시가 생성된 모델과 변경된 모델 간 전환 시 다음 요청에서 새 캐시 생성이 필요할 수 있음.
- 프리셋 외 모델 입력은 지원하지 않으므로 신규 실험 모델 즉시 적용은 불가.

## Rollback
- `SettingFragment`/`AppSettingsStore`/런타임 주입 변경을 되돌리고 `settingsEmptyFragment` + `SettingsEmptyFragment` 경로로 복원.
